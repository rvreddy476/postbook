(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2842:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>i});var o=r(3365),a=r(7246),s=r(1971);let i=e=>{let{...t}=e,{theme:r="system"}=(0,a.D)();return(0,o.jsx)(s.l$,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})}},3169:(e,t,r)=>{Promise.resolve().then(r.bind(r,5240)),Promise.resolve().then(r.bind(r,2842)),Promise.resolve().then(r.t.bind(r,7826,23)),Promise.resolve().then(r.t.bind(r,8534,23)),Promise.resolve().then(r.t.bind(r,6002,23))},4130:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var o=r(4584),a=r(2292);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,o.$)(t))}},5240:(e,t,r)=>{"use strict";r.d(t,{Providers:()=>g});var o=r(3365),a=r(6918),s=r(4111),i=r(1521),n=r(2383),l=r(4130);let u=n.Kq;n.bL,n.l9,i.forwardRef((e,t)=>{let{className:r,sideOffset:a=4,...s}=e;return(0,o.jsx)(n.ZL,{children:(0,o.jsx)(n.UC,{ref:t,sideOffset:a,className:(0,l.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",r),...s})})}).displayName=n.UC.displayName;var d=r(5712),c=r(7727);let f=new a.E({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1}}});function g(e){let{children:t}=e;return(0,o.jsx)(s.Ht,{client:f,children:(0,o.jsx)(d.O,{children:(0,o.jsx)(u,{children:(0,o.jsx)(c.F,{children:t})})})})}},5712:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,O:()=>u});var o=r(3365),a=r(1521),s=r(627);let i=(0,a.createContext)(void 0),n="postbook_token",l="postbook_user";function u(e){let{children:t}=e,[r,u]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[f,g]=(0,a.useState)(!0),h=(0,s.useRouter)(),m=!!d&&!!r;(0,a.useEffect)(()=>{let e=localStorage.getItem(n),t=localStorage.getItem(l);e&&t&&(c(e),u(JSON.parse(t))),g(!1)},[]);let p=(0,a.useCallback)(async(e,t)=>{g(!0);try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailOrPhone:e,password:t})});if(!r.ok){let e=await r.json();throw Error(e.message||"Login failed")}let o=await r.json();c(o.token),u(o.user),localStorage.setItem(n,o.token),localStorage.setItem(l,JSON.stringify(o.user)),h.push("/feed")}finally{g(!1)}},[h]),b=(0,a.useCallback)(async e=>{g(!0);try{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.message||"Registration failed")}let r=await t.json();c(r.token),u(r.user),localStorage.setItem(n,r.token),localStorage.setItem(l,JSON.stringify(r.user)),h.push("/feed")}finally{g(!1)}},[h]),v=(0,a.useCallback)(()=>{c(null),u(null),localStorage.removeItem(n),localStorage.removeItem(l),h.push("/")},[h]);return(0,a.useEffect)(()=>{(async()=>{if(d)try{(await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(d)}})).ok||v()}catch(e){v()}})()},[d,v]),(0,o.jsx)(i.Provider,{value:{user:r,token:d,isLoading:f,isAuthenticated:m,login:p,register:b,logout:v},children:t})}function d(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6002:()=>{},7727:(e,t,r)=>{"use strict";r.d(t,{$:()=>n,F:()=>i});var o=r(3365),a=r(1521);let s=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,a.useState)(!1),[n,l]=(0,a.useState)([]);return(0,o.jsx)(s.Provider,{value:{isSidebarOpen:r,toggleSidebar:()=>i(e=>!e),closeSidebar:()=>i(!1),activeChats:n,openChat:e=>{n.find(t=>t.id===e.id)||l(t=>{let r=[...t,e];return r.length>2?r.slice(r.length-2):r})},closeChat:e=>{l(t=>t.filter(t=>t.id!==e))}},children:t})}function n(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useMessenger must be used within a MessengerProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[61,828,436,955,671,950,81,347,870,358],()=>t(3169)),_N_E=e.O()}]);