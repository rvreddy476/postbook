(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{951:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var s=a(3365),r=a(1521),i=a(5712),l=a(8005),d=a(3155),n=a(3809),o=a(2934),c=a(4130);let u=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,c.cn)(u(),a),...r})});m.displayName=n.b.displayName;var f=a(8159),p=a(5561),h=a(7397),x=a(2446),g=a(7811),b=a(1e3);let v=h.bL;h.YJ;let y=h.WT,N=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(h.l9,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[r,(0,s.jsx)(h.In,{asChild:!0,children:(0,s.jsx)(x.A,{className:"h-4 w-4 opacity-50"})})]})});N.displayName=h.l9.displayName;let j=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})});j.displayName=h.PP.displayName;let w=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})});w.displayName=h.wn.displayName;let C=r.forwardRef((e,t)=>{let{className:a,children:r,position:i="popper",...l}=e;return(0,s.jsx)(h.ZL,{children:(0,s.jsxs)(h.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...l,children:[(0,s.jsx)(j,{}),(0,s.jsx)(h.LM,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(w,{})]})})});C.displayName=h.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.JU,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=h.JU.displayName;let k=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(h.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(h.VF,{children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})}),(0,s.jsx)(h.p4,{children:r})]})});k.displayName=h.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(h.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=h.wv.displayName;var R=a(1971);function P(e){let{title:t,description:a,variant:s}=e;"destructive"===s?R.oR.error(t,{description:a}):R.oR.success(t,{description:a})}var S=a(3678),O=a(627);function E(){let{login:e,register:t,isLoading:a,isAuthenticated:n}=(0,i.A)(),{toast:o}={toast:P,dismiss:R.oR.dismiss},c=(0,O.useRouter)(),[u,h]=(0,r.useState)({emailOrPhone:"",password:""}),[x,g]=(0,r.useState)({username:"",email:"",password:"",firstName:"",lastName:"",phoneNumber:"",dateOfBirth:"",gender:""});(0,r.useEffect)(()=>{n&&c.push("/feed")},[n,c]);let b=async t=>{t.preventDefault();try{await e(u.emailOrPhone,u.password),o({title:"Welcome back!",description:"Successfully logged in."})}catch(e){o({title:"Login failed",description:e instanceof Error?e.message:"Please check your credentials.",variant:"destructive"})}},j=async e=>{e.preventDefault();try{await t({username:x.email.split("@")[0],email:x.email,password:x.password,firstName:x.firstName,lastName:x.lastName,phoneNumber:x.phoneNumber||void 0}),o({title:"Welcome to PostBook!",description:"Your account has been created."})}catch(e){o({title:"Registration failed",description:e instanceof Error?e.message:"Please try again.",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"min-h-screen w-full flex items-center justify-center bg-background p-4 relative overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[(0,s.jsx)("div",{className:"absolute -top-24 -left-24 w-96 h-96 bg-primary/20 rounded-full blur-3xl"}),(0,s.jsx)("div",{className:"absolute top-1/2 -right-24 w-80 h-80 bg-secondary/20 rounded-full blur-3xl"}),(0,s.jsx)("div",{className:"absolute -bottom-24 left-1/3 w-96 h-96 bg-accent/20 rounded-full blur-3xl"})]}),(0,s.jsxs)("div",{className:"w-full max-w-md z-10",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-heading font-bold text-primary mb-2 tracking-tight","data-testid":"logo-title",children:"PostBook"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect, Share, Watch."})]}),(0,s.jsxs)(f.Zp,{className:"border-border/50 shadow-xl glass-panel",children:[(0,s.jsx)(f.Wu,{className:"pt-6",children:(0,s.jsxs)(p.tU,{defaultValue:"login",className:"w-full",children:[(0,s.jsxs)(p.j7,{className:"grid w-full grid-cols-2 mb-6",children:[(0,s.jsx)(p.Xi,{value:"login","data-testid":"tab-login",children:"Login"}),(0,s.jsx)(p.Xi,{value:"register","data-testid":"tab-register",children:"Register"})]}),(0,s.jsx)(p.av,{value:"login",children:(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"email",children:"Email or Phone"}),(0,s.jsx)(d.p,{id:"email",type:"text",placeholder:"Enter your email or phone",required:!0,"data-testid":"input-login-email",value:u.emailOrPhone,onChange:e=>h(t=>({...t,emailOrPhone:e.target.value})),disabled:a})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"password",children:"Password"}),(0,s.jsx)(d.p,{id:"password",type:"password",placeholder:"Enter your password",required:!0,"data-testid":"input-login-password",value:u.password,onChange:e=>h(t=>({...t,password:e.target.value})),disabled:a})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("a",{href:"#",className:"text-sm text-primary hover:underline",children:"Forgot password?"})}),(0,s.jsx)(l.$,{type:"submit",className:"w-full text-white font-semibold text-lg h-12",disabled:a,"data-testid":"button-login",children:a?(0,s.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):"Log In"})]})}),(0,s.jsx)(p.av,{value:"register",children:(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"firstName",children:"First Name"}),(0,s.jsx)(d.p,{id:"firstName",placeholder:"John",required:!0,"data-testid":"input-register-firstname",value:x.firstName,onChange:e=>g(t=>({...t,firstName:e.target.value})),disabled:a})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"lastName",children:"Last Name"}),(0,s.jsx)(d.p,{id:"lastName",placeholder:"Doe",required:!0,"data-testid":"input-register-lastname",value:x.lastName,onChange:e=>g(t=>({...t,lastName:e.target.value})),disabled:a})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"reg-phone",children:"Phone Number"}),(0,s.jsx)(d.p,{id:"reg-phone",type:"tel",placeholder:"+1 (555) 000-0000","data-testid":"input-register-phone",value:x.phoneNumber,onChange:e=>g(t=>({...t,phoneNumber:e.target.value})),disabled:a})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"reg-email",children:"Email Address"}),(0,s.jsx)(d.p,{id:"reg-email",type:"email",placeholder:"john.doe@example.com",required:!0,"data-testid":"input-register-email",value:x.email,onChange:e=>g(t=>({...t,email:e.target.value})),disabled:a})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{children:"Date of Birth"}),(0,s.jsx)(d.p,{type:"date",className:"block","data-testid":"input-register-dob",value:x.dateOfBirth,onChange:e=>g(t=>({...t,dateOfBirth:e.target.value})),disabled:a})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{children:"Gender"}),(0,s.jsxs)(v,{value:x.gender,onValueChange:e=>g(t=>({...t,gender:e})),disabled:a,children:[(0,s.jsx)(N,{"data-testid":"select-register-gender",children:(0,s.jsx)(y,{placeholder:"Select"})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{value:"male",children:"Male"}),(0,s.jsx)(k,{value:"female",children:"Female"}),(0,s.jsx)(k,{value:"other",children:"Other"}),(0,s.jsx)(k,{value:"prefer-not-to-say",children:"Prefer not to say"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m,{htmlFor:"reg-password",children:"Password"}),(0,s.jsx)(d.p,{id:"reg-password",type:"password",placeholder:"Create a password",required:!0,"data-testid":"input-register-password",value:x.password,onChange:e=>g(t=>({...t,password:e.target.value})),disabled:a})]}),(0,s.jsx)(l.$,{type:"submit",className:"w-full text-white font-semibold text-lg h-12 mt-2",disabled:a,"data-testid":"button-register",children:a?(0,s.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):"Create Account"})]})})]})}),(0,s.jsx)(f.wL,{className:"flex justify-center border-t border-border/50 pt-6 pb-6",children:(0,s.jsxs)("p",{className:"text-xs text-center text-muted-foreground",children:["By continuing, you agree to PostBook's ",(0,s.jsx)("a",{href:"#",className:"text-primary hover:underline",children:"Terms of Service"})," and ",(0,s.jsx)("a",{href:"#",className:"text-primary hover:underline",children:"Privacy Policy"}),"."]})})]})]})]})}},3155:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var s=a(3365),r=a(1521),i=a(4130);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},4130:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(4584),r=a(2292);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},5561:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>o,av:()=>c,j7:()=>n,tU:()=>d});var s=a(3365),r=a(1521),i=a(6275),l=a(4130);let d=i.bL,n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.B8,{ref:t,className:(0,l.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...r})});n.displayName=i.B8.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...r})});o.displayName=i.l9.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});c.displayName=i.UC.displayName},5712:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,O:()=>o});var s=a(3365),r=a(1521),i=a(627);let l=(0,r.createContext)(void 0),d="postbook_token",n="postbook_user";function o(e){let{children:t}=e,[a,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[m,f]=(0,r.useState)(!0),p=(0,i.useRouter)(),h=!!c&&!!a;(0,r.useEffect)(()=>{let e=localStorage.getItem(d),t=localStorage.getItem(n);e&&t&&(u(e),o(JSON.parse(t))),f(!1)},[]);let x=(0,r.useCallback)(async(e,t)=>{f(!0);try{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailOrPhone:e,password:t})});if(!a.ok){let e=await a.json();throw Error(e.message||"Login failed")}let s=await a.json();u(s.token),o(s.user),localStorage.setItem(d,s.token),localStorage.setItem(n,JSON.stringify(s.user)),p.push("/feed")}finally{f(!1)}},[p]),g=(0,r.useCallback)(async e=>{f(!0);try{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.message||"Registration failed")}let a=await t.json();u(a.token),o(a.user),localStorage.setItem(d,a.token),localStorage.setItem(n,JSON.stringify(a.user)),p.push("/feed")}finally{f(!1)}},[p]),b=(0,r.useCallback)(()=>{u(null),o(null),localStorage.removeItem(d),localStorage.removeItem(n),p.push("/")},[p]);return(0,r.useEffect)(()=>{(async()=>{if(c)try{(await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(c)}})).ok||b()}catch(e){b()}})()},[c,b]),(0,s.jsx)(l.Provider,{value:{user:a,token:c,isLoading:m,isAuthenticated:h,login:x,register:g,logout:b},children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6238:(e,t,a)=>{Promise.resolve().then(a.bind(a,951))},8005:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(3365),r=a(1521),i=a(544),l=a(2934),d=a(4130);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground shadow-sm border-destructive-border",outline:" border [border-color:var(--button-outline)] shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,s.jsx)(u,{className:(0,d.cn)(n({variant:r,size:l,className:a})),ref:t,...c})});o.displayName="Button"},8159:(e,t,a)=>{"use strict";a.d(t,{Wu:()=>n,Zp:()=>l,aR:()=>d,wL:()=>o});var s=a(3365),r=a(1521),i=a(4130);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});l.displayName="Card";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...r})});d.displayName="CardHeader",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",a),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...r})});n.displayName="CardContent";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...r})});o.displayName="CardFooter"}},e=>{var t=t=>e(e.s=t);e.O(0,[436,955,844,671,950,297,347,870,358],()=>t(6238)),_N_E=e.O()}]);